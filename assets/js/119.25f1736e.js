(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{517:function(s,a,e){"use strict";e.r(a);var t=e(56),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"docker基础"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker基础"}},[s._v("#")]),s._v(" Docker基础")]),s._v(" "),e("h2",{attrs:{id:"_1、docker概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、docker概述"}},[s._v("#")]),s._v(" 1、Docker概述")]),s._v(" "),e("h3",{attrs:{id:"docker为什么会出现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker为什么会出现"}},[s._v("#")]),s._v(" Docker为什么会出现")]),s._v(" "),e("p",[s._v("开发即运维！")]),s._v(" "),e("p",[s._v("环境配置是十分麻烦的，每一个机器都要部署环境，费时费力")]),s._v(" "),e("p",[s._v("发布一个项目 ( jar + (Redis MySQL jdk ES) )")]),s._v(" "),e("p",[s._v("项目和环境打包发布")]),s._v(" "),e("p",[s._v("传统：开发jar，运维来做")]),s._v(" "),e("p",[s._v("现在：开发打包部署上线，一套流程做完")]),s._v(" "),e("p",[s._v("java--apk--发布 (应用商店)--用户使用apk--安装即可用")]),s._v(" "),e("p",[s._v("java--jar (环境) --打包项目带上环境 (镜像)--Docker仓库--下载我们发布的镜像--下载使用")]),s._v(" "),e("p",[s._v("Docker给以上的问题，提出了解决方案")]),s._v(" "),e("p",[s._v("Docker的思想来自于集装箱")]),s._v(" "),e("p",[e("strong",[s._v("隔离")]),s._v("：docker核心思想。打包装箱，每个箱子互相隔离")]),s._v(" "),e("p",[s._v("Docker 通过隔离机制，可以将服务器利用到极致")]),s._v(" "),e("p",[s._v("本质：所有的技术都是因为出现了一些问题，我们需要去解决，才去学习")]),s._v(" "),e("h3",{attrs:{id:"docker的历史"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker的历史"}},[s._v("#")]),s._v(" Docker的历史")]),s._v(" "),e("p",[s._v("2010年，几个搞it的年轻人，就在美国成立了一家公司 "),e("strong",[s._v("dotCloud")]),s._v(" 做一些 pass 的云计算服务。Linux有关的容器技术。")]),s._v(" "),e("p",[s._v("他们将自己的技术（容器化技术）命名就是Docker。")]),s._v(" "),e("p",[s._v("Docker刚刚诞生的时候，没有引起行业注意。")]),s._v(" "),e("p",[s._v("dotCloud，要恰饭 ------\x3e "),e("strong",[s._v("开源")])]),s._v(" "),e("p",[s._v("开发源代码！")]),s._v(" "),e("p",[s._v("2013年，将Docker开源")]),s._v(" "),e("p",[s._v("越来越多的人发现了Docker的优点！火了，几乎每个月都会更新一个版本")]),s._v(" "),e("p",[s._v("2014年4月9日，Docker1.0发布")]),s._v(" "),e("p",[s._v("入门 ------\x3e 精通")]),s._v(" "),e("p",[s._v("Docker为什么这么火？十分的轻巧！")]),s._v(" "),e("p",[s._v("在容器技术出来之前，我们都是使用虚拟机技术")]),s._v(" "),e("p",[s._v("虚拟机：在window中装一个Vmware，通过软件虚拟出来一台或多台计算机，"),e("strong",[s._v("笨重")])]),s._v(" "),e("p",[s._v("Docker容器技术，同样是一种虚拟机技术")]),s._v(" "),e("p",[s._v("去掉了虚拟硬件层：Hypeviscr & Guest OS——>Docker Engine")]),s._v(" "),e("p",[s._v("虚拟机面向硬件，Docker面向软件")]),s._v(" "),e("h3",{attrs:{id:"docker运行机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker运行机制"}},[s._v("#")]),s._v(" Docker运行机制")]),s._v(" "),e("p",[s._v("Client-Server（CS）结构")]),s._v(" "),e("p",[s._v("运行主机（Server）中运行着一个个容器（集装箱）以及后台守护进程（Daemon），保存着镜像，客户机（Client）通过下达命令（API），连接后台守护进程（Daemon），对容器进行操作")]),s._v(" "),e("p",[s._v("容器相当于一个简易版的Linux系统（集装箱），运行在宿主机上（鲸背），巨大的仓库像是大海一般支撑着鲸鱼")]),s._v(" "),e("p",[e("strong",[s._v("docker镜像")])]),s._v(" "),e("p",[s._v("联合文件系统（UnionFS）：一层一层叠加，拢和成一个文件，即镜像")]),s._v(" "),e("p",[s._v("bootfs（boot file system）& rootfs（root file system）")]),s._v(" "),e("p",[s._v("kernel（内核）：宿主机内核")]),s._v(" "),e("p",[s._v("容器层 ——> 镜像")]),s._v(" "),e("p",[s._v("分层 ——> 共享资源")]),s._v(" "),e("h2",{attrs:{id:"_2、在centos-7上配置docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、在centos-7上配置docker"}},[s._v("#")]),s._v(" 2、在CentOS 7上配置Docker")]),s._v(" "),e("p",[s._v("1、安装之前现卸载系统上原有的Docker")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("yum remove docker \\\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("common \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("engine\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("执行结果")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@instance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h9cwbr8m "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# yum remove docker \\\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("common \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate \\\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("engine\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Loaded")]),s._v(" plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" langpacks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" versionlock\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("common\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("latest"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("logrotate\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Match")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" argument"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("engine\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Packages")]),s._v(" marked "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" removal\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \t\t\t\t    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@instance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h9cwbr8m "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("C")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("p",[s._v("2、安装需要的安装包yum-utils")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@instance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h9cwbr8m "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# yum install "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y yum"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utils\n    \n\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Loaded")]),s._v(" plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" langpacks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" versionlock\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Excluding")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" update due "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("versionlock")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("use "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yum versionlock status"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("show")]),s._v(" it"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Package")]),s._v(" yum"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utils"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".31")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("54.")]),s._v("el7_8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("noarch already installed and latest version\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nothing")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@instance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h9cwbr8m "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("此主机已安装最新的yum-utils")]),s._v(" "),e("p",[s._v("3、设置镜像仓库地址")]),s._v(" "),e("p",[s._v("docker默认的官方仓库地址")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("yum"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("config"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manager \\\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("add"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("repo \\\n    https"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("download"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("centos"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("此地址为官方的仓库地址，在国内建议不要用")]),s._v(" "),e("p",[s._v("阿里云的镜像仓库地址")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v(" yum"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("config"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manager \\\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("add"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("repo \\\n   http"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("centos"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("还有很多其他的仓库地址，如：网友云、有道等")]),s._v(" "),e("p",[s._v("4、安装docker相关的引擎")]),s._v(" "),e("p",[s._v("#先更新yum软件包索引")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("yum makecache fase \n")])])]),e("p",[s._v("docker社区、ee企业版 ce为社区版 官方推荐使用ce版，默认安装最新的docker\n版本，也可以指定版本安装")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("yum install docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli containerd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("5、启动docker")]),s._v(" "),e("p",[s._v("启动命令")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("systemctl  start  docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("6、使用docker version 查看dockers是否启动")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("docker version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("原文链接：https://blog.csdn.net/qq_26400011/article/details/113856681")]),s._v(" "),e("p",[s._v("7、设置阿里云镜像加速")]),s._v(" "),e("p",[s._v("在阿里云官网获得加速地址")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors",target:"_blank",rel:"noopener noreferrer"}},[s._v("容器镜像服务 (aliyun.com)"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("配置/etc/docker/daemon.json文件")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("sudo mkdir "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker\nsudo tee "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("daemon"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token char"}},[s._v("'EOF'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://wvbyitta.mirror.aliyuncs.com"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nEOF\nsudo systemctl daemon"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("reload\nsudo systemctl restart docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h2",{attrs:{id:"_3、docker简单命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、docker简单命令"}},[s._v("#")]),s._v(" 3、Docker简单命令")]),s._v(" "),e("h5",{attrs:{id:"运行命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行命令"}},[s._v("#")]),s._v(" 运行命令")]),s._v(" "),e("p",[s._v("1、service docker restart：重启docker服务")]),s._v(" "),e("p",[s._v("2、docker run + 镜像名m：用镜像m生成容器")]),s._v(" "),e("p",[s._v("3、docker run -it：交互式运行")]),s._v(" "),e("p",[s._v("4、docker run -p 8000:8080：设置对外开放端口和部署端口")]),s._v(" "),e("p",[s._v("5、docker run -P：随机分配端口")]),s._v(" "),e("p",[s._v("6、docker run -d：后台运行")]),s._v(" "),e("p",[s._v("7、docker run --name：给容器命名")]),s._v(" "),e("p",[s._v("8、exit：退出容器")]),s._v(" "),e("p",[s._v("9、ctrl+q+p：将容器挂起")]),s._v(" "),e("p",[s._v("10、docker start：开启容器")]),s._v(" "),e("p",[s._v("11、docker restart：重启容器")]),s._v(" "),e("p",[s._v("12、docker stop：停止容器")]),s._v(" "),e("p",[s._v("13、docker kill：强制停止容器")]),s._v(" "),e("p",[s._v("14、docker exec -it 容器id /bin/bash 交互式运行容器")]),s._v(" "),e("h5",{attrs:{id:"查询命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询命令"}},[s._v("#")]),s._v(" 查询命令")]),s._v(" "),e("p",[s._v("1、docker version：查看docker版本")]),s._v(" "),e("p",[s._v("2、docker info：查看docker信息")]),s._v(" "),e("p",[s._v("3、docker --help：查询命令")]),s._v(" "),e("p",[s._v("4、docker ps：正在运行的容器")]),s._v(" "),e("p",[s._v("5、docker ps -l：最近运行的容器信息")]),s._v(" "),e("p",[s._v("6、docker ps -a：所有运行过的容器信息")]),s._v(" "),e("p",[s._v("7、docker ps -q：正在运行的容器ID")]),s._v(" "),e("p",[s._v("8、docker images：查看镜像（-l -a -q 与5、6、7同理）")]),s._v(" "),e("p",[s._v("9、docker search：在远端查询镜像")]),s._v(" "),e("p",[s._v("10、docker inspect：查看容器具体信息")]),s._v(" "),e("p",[s._v("11、docker top：查看容器内运行进程")]),s._v(" "),e("h5",{attrs:{id:"删除命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除命令"}},[s._v("#")]),s._v(" 删除命令")]),s._v(" "),e("p",[s._v("1、docker rm：删除容器")]),s._v(" "),e("p",[s._v("2、docker rm -f：强制删除容器")]),s._v(" "),e("p",[s._v("3、docker rm -f $ (docker ps -qa)：删除所有容器")]),s._v(" "),e("p",[s._v("4、docker rmi：删除镜像")]),s._v(" "),e("p",[s._v("5、docker rmi -f：强制删除镜像")]),s._v(" "),e("p",[s._v("6、docker rmi -f $ (docker images -qa)")]),s._v(" "),e("h5",{attrs:{id:"生成命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#生成命令"}},[s._v("#")]),s._v(" 生成命令")]),s._v(" "),e("p",[s._v("1、docker pull：从远端获取镜像")]),s._v(" "),e("p",[s._v('2、docker commit -m="镜像名"   -a="作者名 "：用容器生成镜像')]),s._v(" "),e("p",[s._v("3、docker build -f   /.../.../DockerFile (dockerfile路径) -t+镜像名：用dockerfile生成镜像")]),s._v(" "),e("p",[s._v("4、docker run -it -v  /.../.../... (主机目录) 😕...(容器目录)  + 容器c：在主机和容器c之间生成数据共享卷")]),s._v(" "),e("p",[s._v("5、docker run it  --volumes-from+容器名/ID  -name+容器名  镜像名m：用m生成容器，用容器联通容器")]),s._v(" "),e("h2",{attrs:{id:"_4、docker证书连接idea"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、docker证书连接idea"}},[s._v("#")]),s._v(" 4、docker证书连接idea")]),s._v(" "),e("h5",{attrs:{id:"_1、新建一个目录certs-在目录执行以下命令-输入两次密码-需要记住后面会用到"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、新建一个目录certs-在目录执行以下命令-输入两次密码-需要记住后面会用到"}},[s._v("#")]),s._v(" 1、新建一个目录certs，在目录执行以下命令，输入两次密码，需要记住后面会用到")]),s._v(" "),e("p",[s._v("openssl genrsa -aes256 -out ca-key.pem 4096")]),s._v(" "),e("h5",{attrs:{id:"_2、执行以下命令-输入密码-然后依次输入国家是-cn-省例如是shanghai、市shanghai、组织名称、组织单位、姓名或服务器名、邮件地址-都可以随意填写"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、执行以下命令-输入密码-然后依次输入国家是-cn-省例如是shanghai、市shanghai、组织名称、组织单位、姓名或服务器名、邮件地址-都可以随意填写"}},[s._v("#")]),s._v(" 2、执行以下命令，输入密码，然后依次输入国家是 CN，省例如是Shanghai、市Shanghai、组织名称、组织单位、姓名或服务器名、邮件地址，都可以随意填写")]),s._v(" "),e("p",[s._v("openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem")]),s._v(" "),e("h5",{attrs:{id:"_3、执行生成服务器端key证书文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、执行生成服务器端key证书文件"}},[s._v("#")]),s._v(" 3、执行生成服务器端key证书文件")]),s._v(" "),e("p",[s._v("openssl genrsa -out server-key.pem 4096")]),s._v(" "),e("h5",{attrs:{id:"_4、ip需要换成自己服务器的外网ip地址-或者域名都可以"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、ip需要换成自己服务器的外网ip地址-或者域名都可以"}},[s._v("#")]),s._v(" 4、ip需要换成自己服务器的外网ip地址，或者域名都可以")]),s._v(" "),e("p",[s._v('openssl req -subj "/CN=公网ip" -sha256 -new -key server-key.pem -out server.csr')]),s._v(" "),e("h5",{attrs:{id:"_5、配置白名单-多个用逗号隔开-例如-ip-192-168-1-111-ip-0-0-0-0-这里需要注意-虽然0-0-0-0可以匹配任意-但是仍然需要配置你的服务器外网ip-如果省略会造成错误-后面会讲到"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、配置白名单-多个用逗号隔开-例如-ip-192-168-1-111-ip-0-0-0-0-这里需要注意-虽然0-0-0-0可以匹配任意-但是仍然需要配置你的服务器外网ip-如果省略会造成错误-后面会讲到"}},[s._v("#")]),s._v(" 5、配置白名单，多个用逗号隔开，例如： IP:192.168.1.111,IP:0.0.0.0，这里需要注意，虽然0.0.0.0可以匹配任意，但是仍然需要配置你的服务器外网ip，如果省略会造成错误，后面会讲到")]),s._v(" "),e("p",[s._v("echo subjectAltName = IP:"),e("strong",[s._v("公网ip")]),s._v(",IP:0.0.0.0 >> extfile.cnf")]),s._v(" "),e("h5",{attrs:{id:"_6、把-extendedkeyusage-serverauth-键值设置到extfile-cnf文件里-限制扩展只能用在服务器认证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6、把-extendedkeyusage-serverauth-键值设置到extfile-cnf文件里-限制扩展只能用在服务器认证"}},[s._v("#")]),s._v(" 6、把 extendedKeyUsage = serverAuth 键值设置到extfile.cnf文件里，限制扩展只能用在服务器认证")]),s._v(" "),e("p",[s._v("echo extendedKeyUsage = serverAuth >> extfile.cnf")]),s._v(" "),e("h5",{attrs:{id:"_7、执行以下命令-输入之前设置的密码-然后会生成签名的证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7、执行以下命令-输入之前设置的密码-然后会生成签名的证书"}},[s._v("#")]),s._v(" 7、执行以下命令，输入之前设置的密码，然后会生成签名的证书")]),s._v(" "),e("p",[s._v("openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -extfile extfile.cnf")]),s._v(" "),e("h5",{attrs:{id:"_8、生成例如idea等客户端需要用到的密钥文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8、生成例如idea等客户端需要用到的密钥文件"}},[s._v("#")]),s._v(" 8、生成例如idea等客户端需要用到的密钥文件")]),s._v(" "),e("p",[s._v("openssl genrsa -out key.pem 4096")]),s._v(" "),e("h5",{attrs:{id:"_9、生成客户端签名请求需要用到的临时文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9、生成客户端签名请求需要用到的临时文件"}},[s._v("#")]),s._v(" 9、生成客户端签名请求需要用到的临时文件")]),s._v(" "),e("p",[s._v("openssl req -subj '/CN=client' -new -key key.pem -out client.csr")]),s._v(" "),e("h5",{attrs:{id:"_10、继续设置证书扩展属性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10、继续设置证书扩展属性"}},[s._v("#")]),s._v(" 10、继续设置证书扩展属性")]),s._v(" "),e("p",[s._v("echo extendedKeyUsage = clientAuth >> extfile.cnf")]),s._v(" "),e("h5",{attrs:{id:"_11、输入之前的密码生成认证证书-生成正式签名证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11、输入之前的密码生成认证证书-生成正式签名证书"}},[s._v("#")]),s._v(" 11、输入之前的密码生成认证证书，生成正式签名证书")]),s._v(" "),e("p",[s._v("openssl x509 -req -days 365 -sha256 -in client.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out cert.pem -extfile extfile.cnf")]),s._v(" "),e("h5",{attrs:{id:"_12、删除生成的临时文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12、删除生成的临时文件"}},[s._v("#")]),s._v(" 12、删除生成的临时文件")]),s._v(" "),e("p",[s._v("rm -rf client.csr server.csr")]),s._v(" "),e("h5",{attrs:{id:"_13、修改证书为只读权限保证证书安全"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_13、修改证书为只读权限保证证书安全"}},[s._v("#")]),s._v(" 13、修改证书为只读权限保证证书安全")]),s._v(" "),e("p",[s._v("chmod -v 0400 ca-key.pem key.pem server-key.pem")]),s._v(" "),e("p",[s._v("chmod -v 0444 ca.pem server-cert.pem cert.pem")]),s._v(" "),e("h5",{attrs:{id:"_14、复制服务端需要用到的证书到docker配置目录下便于识别使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_14、复制服务端需要用到的证书到docker配置目录下便于识别使用"}},[s._v("#")]),s._v(" 14、复制服务端需要用到的证书到docker配置目录下便于识别使用：")]),s._v(" "),e("p",[s._v("cp server-cert.pem ca.pem server-key.pem /etc/docker/")]),s._v(" "),e("h5",{attrs:{id:"_15、修改docker配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_15、修改docker配置"}},[s._v("#")]),s._v(" 15、修改docker配置")]),s._v(" "),e("p",[s._v("如果是离线手动安装的docker，通常情况下是这个文件：")]),s._v(" "),e("p",[s._v("vim /etc/systemd/system/docker.service")]),s._v(" "),e("p",[s._v("然后在 ExecStart=/usr/bin/dockerd 后面追加一个 \\ ,然后黏贴证书的配置，大概如下：")]),s._v(" "),e("p",[s._v("ExecStart=/usr/bin/dockerd \\")]),s._v(" "),e("p",[s._v("**--tlsverify \\ **")]),s._v(" "),e("p",[s._v("**--tlscacert=/etc/docker/ca.pem \\ **")]),s._v(" "),e("p",[s._v("**--tlscert=/etc/docker/server-cert.pem \\ **")]),s._v(" "),e("p",[s._v("**--tlskey=/etc/docker/server-key.pem \\ **")]),s._v(" "),e("p",[s._v("**-H tcp://0.0.0.0:2375 \\ **")]),s._v(" "),e("p",[s._v("**-H unix:///var/run/docker.sock \\ **")]),s._v(" "),e("p",[s._v("但是，如果是自动使用yum安装的，服务文件地址可能是这个：")]),s._v(" "),e("p",[s._v("vim /lib/systemd/system/docker.service")]),s._v(" "),e("p",[s._v("然后加上红色的部分，然后即可")]),s._v(" "),e("p",[s._v("ExecStart=/usr/bin/dockerd-current \\")]),s._v(" "),e("p",[s._v("**--tlsverify \\ **")]),s._v(" "),e("p",[s._v("**--tlscacert=/etc/docker/ca.pem \\ **")]),s._v(" "),e("p",[s._v("**--tlscert=/etc/docker/server-cert.pem \\ **")]),s._v(" "),e("p",[s._v("**--tlskey=/etc/docker/server-key.pem \\ **")]),s._v(" "),e("p",[s._v("**-H tcp://0.0.0.0:2375 \\ **")]),s._v(" "),e("p",[s._v("-H unix:///var/run/docker.sock \\")]),s._v(" "),e("p",[s._v("--add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \\")]),s._v(" "),e("p",[s._v("--default-runtime=docker-runc \\")]),s._v(" "),e("p",[s._v("--exec-opt native.cgroupdriver=systemd \\")]),s._v(" "),e("p",[s._v("--userland-proxy-path=/usr/libexec/docker/docker-proxy-current \\")]),s._v(" "),e("p",[s._v("--init-path=/usr/libexec/docker/docker-init-current \\")]),s._v(" "),e("p",[s._v("--seccomp-profile=/etc/docker/seccomp.json \\")]),s._v(" "),e("p",[s._v("$OPTIONS \\")]),s._v(" "),e("p",[s._v("$DOCKER_STORAGE_OPTIONS \\")]),s._v(" "),e("p",[s._v("$DOCKER_NETWORK_OPTIONS \\")]),s._v(" "),e("p",[s._v("$ADD_REGISTRY \\")]),s._v(" "),e("p",[s._v("$BLOCK_REGISTRY \\")]),s._v(" "),e("p",[s._v("$INSECURE_REGISTRY \\")]),s._v(" "),e("p",[s._v("$REGISTRIES")]),s._v(" "),e("h5",{attrs:{id:"_16、开放防火墙的2375的端口-若为阿里云服务器-需在网页上防火墙自定义添加规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_16、开放防火墙的2375的端口-若为阿里云服务器-需在网页上防火墙自定义添加规则"}},[s._v("#")]),s._v(" 16、开放防火墙的2375的端口，若为阿里云服务器，需在网页上防火墙自定义添加规则")]),s._v(" "),e("p",[s._v("firewall-cmd --zone=public --add-port=2375/tcp --permanent")]),s._v(" "),e("p",[s._v("firewall-cmd --reload")]),s._v(" "),e("h5",{attrs:{id:"_17、重载服务并重启docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_17、重载服务并重启docker"}},[s._v("#")]),s._v(" 17、重载服务并重启docker")]),s._v(" "),e("p",[s._v("systemctl daemon-reload && systemctl restart docker")]),s._v(" "),e("h5",{attrs:{id:"_18、保存证书客户端文件到本地用于连接docker-我这里用的是sz命令-ftp也可以只要能放到本地客户端即可。也可以用xftp软件操作。在云服务器上需先手动下载sz-rz"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_18、保存证书客户端文件到本地用于连接docker-我这里用的是sz命令-ftp也可以只要能放到本地客户端即可。也可以用xftp软件操作。在云服务器上需先手动下载sz-rz"}},[s._v("#")]),s._v(" 18、保存证书客户端文件到本地用于连接docker，我这里用的是sz命令，ftp也可以只要能放到本地客户端即可。也可以用xftp软件操作。在云服务器上需先手动下载sz/rz")]),s._v(" "),e("p",[s._v("sz命令:")]),s._v(" "),e("p",[s._v("yum install lrzsz")]),s._v(" "),e("p",[s._v("sz ca.pem cert.pem key.pem")]),s._v(" "),e("p",[s._v("Xftp:")]),s._v(" "),e("p",[s._v("公网ip，用户名root，密码在控制台配置")]),s._v(" "),e("p",[s._v("![img](file:///C:\\Users\\NorthBoat\\AppData\\Roaming\\Tencent\\Users\\1543625674\\QQ\\WinTemp\\RichOle\\7ZZBRKFCF_6T2VV[9WNCNT3.png)")]),s._v(" "),e("h5",{attrs:{id:"_19、测试一下证书是否配置成功-如果成功-会输出证书相关信息-如果有fail-请检查证书-在certs文件夹下运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_19、测试一下证书是否配置成功-如果成功-会输出证书相关信息-如果有fail-请检查证书-在certs文件夹下运行"}},[s._v("#")]),s._v(" 19、测试一下证书是否配置成功，如果成功，会输出证书相关信息，如果有fail，请检查证书（在certs文件夹下运行）")]),s._v(" "),e("p",[s._v("docker --tlsverify --tlscacert=ca.pem --tlscert=cert.pem --tlskey=key.pem -H=16.21.2.234:2375 version")]),s._v(" "),e("h5",{attrs:{id:"_20、配置idea"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_20、配置idea"}},[s._v("#")]),s._v(" 20、配置idea")]),s._v(" "),e("p",[s._v("点击idea第一行菜单 run 》edit configurations ，然后点击+号，添加docker配置，选择Dockerfile，")]),s._v(" "),e("p",[s._v("然后选择server属性，弹出docker server配置，")]),s._v(" "),e("p",[s._v("engine api url：https://公网IP:2375")]),s._v(" "),e("p",[s._v("certificates folder：D:\\buy\\ca-docker")]),s._v(" "),e("p",[s._v("连接成功将显示seccussful")]),s._v(" "),e("p",[s._v("原文链接：https://blog.csdn.net/oceanyang520/article/details/101563309")]),s._v(" "),e("p",[s._v("上述命令脚本（cert.sh）：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.75.201"')]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2084team-docker-tls"')]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shell script is doing"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start file"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /mydata/docker-ca "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /mydata/docker-ca\nopenssl genrsa -aes256 -passout pass:"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PASSWORD")]),s._v(" -out ca-key.pem "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\nopenssl req -new -x509 -passin "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pass:'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PASSWORD")]),s._v('"')]),s._v(" -days "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("365")]),s._v(" -key ca-key.pem -sha256 -subj "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/CN='),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SERVER")]),s._v('"')]),s._v(" -out ca.pem\nopenssl genrsa -out server-key.pem "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\nopenssl req -subj "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/CN='),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SERVER")]),s._v('"')]),s._v(" -sha256 -new -key server-key.pem -out server.csr\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo \"subjectAltName = IP:'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SERVER")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("',IP:0.0.0.0\" >> extfile.cnf'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo \"extendedKeyUsage = serverAuth\" >> extfile.cnf'")]),s._v("\nopenssl x509 -req -days "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("365")]),s._v(" -sha256 -passin "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pass:'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PASSWORD")]),s._v('"')]),s._v(" -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -extfile extfile.cnf\nopenssl genrsa -out key.pem "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\nopenssl req -subj "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/CN=client"')]),s._v(" -new -key key.pem -out client.csr\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" extendedKeyUsage "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" clientAuth "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" extfile-client.cnf\nopenssl x509 -req -days "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("365")]),s._v(" -sha256 -passin "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pass:'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PASSWORD")]),s._v('"')]),s._v(" -in client.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out cert.pem -extfile extfile-client.cnf\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf ca.srl server.csr client.csr extfile-client.cnf extfile.cnf\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"end file"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shell script is done"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);